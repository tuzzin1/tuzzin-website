import{au as ne,r as N,C as H,aw as fe,aM as pe,ax as ve,av as le,L as B,az as he,aN as ge,D as M,i as A,w as V,f as R,H as a,a0 as ue,aA as U,aO as P,V as ce,aP as me,aQ as ye,aR as be,aS as j,aT as xe,E as Ce,aU as ae,W as ke,y as Te,a8 as Ie,X as se,O as Ee,aJ as Ke,d as O,g as F,n as _,G as Se,F as ie,Z as we,a1 as _e,e as re,a3 as Ae,t as Be}from"./BX_-9X7U.js";import Re from"./ZhNPDAst.js";import{_ as Le}from"./Bn5TF7Qm.js";function G(u,i,t){const p=u.findIndex(g=>ne(g,i)),E=u.findIndex(g=>ne(g,t));if(p===-1||E===-1)return[];const[l,v]=[p,E].sort((g,d)=>g-d);return u.slice(l,v+1)}function q(u){return u.reduce((i,t)=>(i.push(t),t.children&&i.push(...q(t.children)),i),[])}function Ve(u,i){const t=N(),p=(l,v)=>{if(i.multiple&&Array.isArray(u.value))if(i.selectionBehavior==="replace")u.value=[l],t.value=l;else{const g=u.value.findIndex(d=>v(d));g!==-1?u.value.splice(g,1):u.value.push(l)}else i.selectionBehavior==="replace"?u.value={...l}:!Array.isArray(u.value)&&v(u.value)?u.value=void 0:u.value={...l};return u.value};function E(l,v,g,d){var S;if(!(t!=null&&t.value)||!i.multiple||!Array.isArray(u.value))return;const K=(S=g().filter(w=>w.ref.dataset.disabled!=="").find(w=>w.ref===v))==null?void 0:S.value;if(!K)return;let k=null;switch(l){case"prev":case"next":{k=G(d,t.value,K);break}case"first":{k=G(d,t.value,d==null?void 0:d[0]);break}case"last":{k=G(d,t.value,d==null?void 0:d[d.length-1]);break}}u.value=k}return{firstValue:t,onSelectItem:p,handleMultipleReplace:E}}const[$e,De]=he("TreeRoot"),Ne=H({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:u=>u.children},selectionBehavior:{default:"toggle"},multiple:{type:Boolean},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(u,{emit:i}){const t=u,p=i,{items:E,multiple:l,disabled:v,propagateSelect:g,dir:d}=fe(t),{handleTypeaheadSearch:T}=pe(),K=ve(d),k=N(),S=N(!1),w=ge(),m=le(t,"modelValue",p,{defaultValue:t.defaultValue??(l.value?[]:void 0),passive:t.modelValue===void 0,deep:!0}),s=le(t,"expanded",p,{defaultValue:t.defaultExpanded??[],passive:t.expanded===void 0,deep:!0}),{onSelectItem:f,handleMultipleReplace:e}=Ve(m,t),r=B(()=>l.value&&Array.isArray(m.value)?m.value.map(n=>t.getKey(n)):[t.getKey(m.value??{})]);function o(n,c=1,x){return n.reduce((C,I,L)=>{const $=t.getKey(I),D=t.getChildren(I),W=s.value.includes($),z={_id:$,value:I,index:L,level:c,parentItem:x,hasChildren:!!D,bind:{value:I,level:c,"aria-setsize":n.length,"aria-posinset":L+1}};return C.push(z),D&&W&&C.push(...o(D,c+1,I)),C},[])}const h=B(()=>{const n=t.items;return s.value.map(c=>c),o(n??[])});function y(n){var c;if(S.value)w.trigger(n);else{const x=((c=k.value)==null?void 0:c.getItems())??[];T(n.key,x)}}function b(n){if(S.value)return;const c=ye[n.key];be(()=>{var x;e(c,j(),(x=k.value)==null?void 0:x.getItems,h.value.map(C=>C.value))})}return De({modelValue:m,selectedKeys:r,onSelect:n=>{var C;const c=I=>t.getKey(I??{})===t.getKey(n),x=t.multiple&&Array.isArray(m.value)?((C=m.value)==null?void 0:C.findIndex(c))!==-1:void 0;if(f(n,c),t.propagateSelect&&t.multiple&&Array.isArray(m.value)){const I=q(t.getChildren(n)??[]);x?m.value=[...m.value].filter(L=>!I.some($=>t.getKey(L??{})===t.getKey($))):m.value=[...m.value,...I]}},expanded:s,onToggle(n){if(!(n?t.getChildren(n):void 0))return;const x=t.getKey(n)??n;s.value.includes(x)?s.value=s.value.filter(C=>C!==x):s.value.push(x)},getKey:t.getKey,getChildren:t.getChildren,items:E,expandedItems:h,disabled:v,multiple:l,dir:K,propagateSelect:g,isVirtual:S,virtualKeydownHook:w,handleMultipleReplace:e}),(n,c)=>(A(),M(a(me),{ref_key:"rovingFocusGroupRef",ref:k,"as-child":"",orientation:"vertical",dir:a(K)},{default:V(()=>[R(a(ue),{role:"tree",as:n.as,"as-child":n.asChild,"aria-multiselectable":a(l)?!0:void 0,onKeydown:[y,U(P(b,["shift"]),["up","down"])]},{default:V(()=>[ce(n.$slots,"default",{flattenItems:h.value,modelValue:a(m),expanded:a(s)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),Oe="tree.select",Pe="tree.toggle",Me=H({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(u,{expose:i,emit:t}){const p=u,E=t,l=$e(),{getItems:v}=xe(),g=B(()=>!!l.getChildren(p.value)),d=B(()=>{const e=l.getKey(p.value);return l.expanded.value.includes(e)}),T=B(()=>{const e=l.getKey(p.value);return l.selectedKeys.value.includes(e)}),K=B(()=>{if(l.propagateSelect.value&&T.value&&g.value&&Array.isArray(l.modelValue.value))return!q(l.getChildren(p.value)||[]).every(r=>l.modelValue.value.find(o=>l.getKey(o)===l.getKey(r)))});function k(e){if(g.value)if(d.value){const r=v().map(n=>n.ref),o=j(),h=r.indexOf(o),b=[...r].slice(h).find(n=>Number(n.getAttribute("data-indent"))===p.level+1);b&&b.focus()}else f(e)}function S(e){if(d.value)f(e);else{const r=v().map(n=>n.ref),o=j(),h=r.indexOf(o),b=[...r].slice(0,h).reverse().find(n=>Number(n.getAttribute("data-indent"))===p.level-1);b&&b.focus()}}async function w(e){E("select",e),!(e!=null&&e.defaultPrevented)&&l.onSelect(p.value)}async function m(e){E("toggle",e),!(e!=null&&e.defaultPrevented)&&l.onToggle(p.value)}async function s(e){if(!e)return;const r={originalEvent:e,value:p.value,isExpanded:d.value,isSelected:T.value};ae(Oe,w,r)}async function f(e){if(!e)return;const r={originalEvent:e,value:p.value,isExpanded:d.value,isSelected:T.value};ae(Pe,m,r)}return i({isExpanded:d,isSelected:T,isIndeterminate:K,handleToggle:()=>l.onToggle(p.value),handleSelect:()=>l.onSelect(p.value)}),(e,r)=>(A(),M(a(Le),{"as-child":"",value:e.value,"allow-shift-key":""},{default:V(()=>[R(a(ue),Ce(e.$attrs,{role:"treeitem",as:e.as,"as-child":e.asChild,"aria-selected":T.value,"aria-expanded":g.value?d.value:void 0,"aria-level":e.level,"data-indent":e.level,"data-selected":T.value?"":void 0,"data-expanded":d.value?"":void 0,onKeydown:[U(P(s,["self","prevent"]),["enter","space"]),r[0]||(r[0]=U(P(o=>a(l).dir.value==="ltr"?k(o):S(o),["prevent"]),["right"])),r[1]||(r[1]=U(P(o=>a(l).dir.value==="ltr"?S(o):k(o),["prevent"]),["left"]))],onClick:r[2]||(r[2]=P(o=>{s(o),f(o)},["stop"]))}),{default:V(()=>[ce(e.$slots,"default",{isExpanded:d.value,isSelected:T.value,isIndeterminate:K.value,handleSelect:()=>a(l).onSelect(e.value),handleToggle:()=>a(l).onToggle(e.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),We={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-(--ui-border-muted) rounded-[calc(var(--ui-radius)*1.5)]",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-(--ui-border-muted) overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-(--ui-border)",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-(--ui-text-highlighted) before:bg-(--ui-bg-elevated)"},false:{link:["hover:text-(--ui-text-highlighted) hover:before:bg-(--ui-bg-elevated)/50","transition-colors before:transition-colors"]}}}},ze=_e;var oe,de;const Fe=se({extend:se(We),...((de=(oe=ze.uiPro)==null?void 0:oe.prose)==null?void 0:de.codeTree)||{}}),Ue=H({__name:"CodeTree",props:{defaultValue:{},class:{},ui:{}},setup(u){const i=u,t=ke(),p=Te(),[E,l]=Ie(),v=Fe(),g=N(i.defaultValue?{path:i.defaultValue}:void 0),d=N(),T=N(1),K=B(()=>{var s,f;return T.value,((f=(s=t.default)==null?void 0:s.call(t))==null?void 0:f.flatMap(w).filter(Boolean))||[]}),k=B(()=>S(K.value));function S(s){const f=new Map,e=[];s.forEach(o=>{const h=o.label.split("/");let y="";h.forEach((b,n)=>{var c,x;if(y=y?`${y}/${b}`:b,!f.has(y)){const C={label:b,path:y,...n<h.length-1&&{children:[]}};f.set(y,C),n===0?e.push(C):(x=(c=f.get(h.slice(0,n).join("/")))==null?void 0:c.children)==null||x.push(C)}})});const r=o=>o.sort((h,y)=>!!h.children==!!y.children?h.label.localeCompare(y.label):y.children?1:-1).map(h=>({...h,children:h.children&&r(h.children)}));return r(e)}function w(s,f){var e,r,o,h;return typeof s.type=="symbol"?(e=s.children)==null?void 0:e.map(w):{label:((r=s.props)==null?void 0:r.filename)||((o=s.props)==null?void 0:o.label)||`${f}`,icon:(h=s.props)==null?void 0:h.icon,component:s}}const m=B(()=>{var e;const s=(e=g.value)==null?void 0:e.path;if(!s)return[];const f=s.split("/");return f.map((r,o)=>f.slice(0,o+1).join("/"))});return Ee(g,s=>{const f=K.value.find(e=>(s==null?void 0:s.path)===e.label);f!=null&&f.component&&(d.value=f)},{immediate:!0}),Ke(()=>T.value++),(s,f)=>{var r,o,h,y;const e=Ae;return A(),O(ie,null,[R(a(E),null,{default:V(({items:b,level:n})=>[(A(!0),O(ie,null,we(b,(c,x)=>{var C,I;return A(),O("li",{key:`${n}-${x}`,class:_(n>0?a(v).itemWithChildren({class:(C=i.ui)==null?void 0:C.itemWithChildren}):a(v).item({class:(I=i.ui)==null?void 0:I.item}))},[R(a(Me),{"as-child":"",level:n,value:c},{default:V(({isExpanded:L,isSelected:$})=>{var D,W,z,J,Q,X,Y,Z,ee,te;return[F("button",{class:_(a(v).link({class:(D=i.ui)==null?void 0:D.link,active:$}))},[(W=c.children)!=null&&W.length?(A(),M(e,{key:0,name:L?a(p).ui.icons.folderOpen:a(p).ui.icons.folder,class:_(a(v).linkLeadingIcon({class:(z=i.ui)==null?void 0:z.linkLeadingIcon}))},null,8,["name","class"])):(A(),M(Re,{key:1,filename:c.label,class:_(a(v).linkLeadingIcon({class:(J=i.ui)==null?void 0:J.linkLeadingIcon}))},null,8,["filename","class"])),F("span",{class:_(a(v).linkLabel({class:(Q=i.ui)==null?void 0:Q.linkLabel}))},Be(c.label),3),(X=c.children)!=null&&X.length?(A(),O("span",{key:2,class:_(a(v).linkTrailing({class:(Y=i.ui)==null?void 0:Y.linkTrailing}))},[R(e,{name:a(p).ui.icons.chevronDown,class:_(a(v).linkTrailingIcon({class:(Z=i.ui)==null?void 0:Z.linkTrailingIcon}))},null,8,["name","class"])],2)):re("",!0)],2),(ee=c.children)!=null&&ee.length&&L?(A(),O("ul",{key:0,class:_(a(v).listWithChildren({class:(te=i.ui)==null?void 0:te.listWithChildren}))},[R(a(l),{items:c.children,level:n+1},null,8,["items","level"])],2)):re("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),F("div",{class:_(a(v).root({class:[i.class,(r=i.ui)==null?void 0:r.root]}))},[R(a(Ne),{modelValue:g.value,"onUpdate:modelValue":f[0]||(f[0]=b=>g.value=b),class:_(a(v).list({class:(o=i.ui)==null?void 0:o.list})),items:k.value,"get-key":b=>b.path,"default-expanded":m.value},{default:V(()=>[R(a(l),{items:k.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),F("div",{class:_(a(v).content({class:(h=i.ui)==null?void 0:h.content}))},[(A(),M(Se((y=d.value)==null?void 0:y.component)))],2)],2)],64)}}}),qe=Object.assign(Ue,{__name:"ProseCodeTree"});export{qe as default};
